<!DOCTYPE HTML> <html> <head> <title>Damian Zaremba - Quick script to get public IPs on a NAT'd server</title> <meta http-equiv=Content-Type content="text/html; charset=UTF-8"/> <meta name=copyright content=">Copyright 2009-2012 Damian Zaremba" /> <meta name=google-site-verification content=qykIg-4DghoGe78ET4eRjKG1cx6n3gXvu4jF0FvcwRo /> <meta name=author content="Damian Zaremba"/> <link rel=alternate type="application/rss+xml" title="Damian Zaremba's Blog" href="http://feeds.feedburner.com/DamianZaremba"/> <meta name=robots content=INDEX /> <meta name=robots content=FOLLOW /> <meta name=robots content="INDEX,FOLLOW"/> <meta name=revisit content="7 days"/> <meta name=classification content=GENERAL /> <meta name=distribution content=GLOBAL /> <meta name=audience content=all /> <meta name=MSSmartTagsPreventParsing content=TRUE /> <link href="/assests/css/main.css" rel=stylesheet type="text/css"/> <link href="/assests/css/pygments.css" rel=stylesheet type="text/css"/> <script src="http://mint.damianzaremba.co.uk/?js" type="text/javascript"></script> <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-11817192-1"]);_gaq.push(["_setDomainName","damianzaremba.co.uk"]);_gaq.push(["_trackPageview"]);(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=("https:"==document.location.protocol?"https://ssl":"http://www");b.src+=".google-analytics.com/ga.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)})();</script> <!--[if IE]>/* hover.htc fixes a bunch of issues with hovering objects in IE */ body { behavior: url("/assests/other/hover.htc"); }<![endif]--> </head> <body> <header> <h1><a href="/">Damian Zaremba</a> <span>Quick script to get public IPs on a NAT'd server</span></h1> <nav> <ul id=main> <li><a href="/">Blog</a></li> <li><a href="/archives">Archives</a></li> <li><a href="/about">About</a></li> <li><a href="/cv">CV</a></li> </ul> </nav> <div id=right> <p> <a href="http://twitter.com/DamianZaremba" title=Twitter><img src="/assests/images/twitter.png"/></a> <a href="https://plus.google.com/110559147647328161061" title=GooglePlus><img src="/assests/images/googleplus.png"/></a> <a href="http://facebook.com/DamianZaremba" title=Facebook><img src="/assests/images/facebook.png"/></a> <a href="https://github.com/DamianZaremba" title=GitHub><img src="/assests/images/github.png"/></a> <a href="http://feeds.feedburner.com/DamianZaremba" title=RSS><img src="/assests/images/rss.png"/></a> </p> <form class=search action="http://google.com/search" method=get> <input class=left type=text name=q results=0> <input type=hidden name=q value="site:damianzaremba.co.uk"> </form> </div> </header> <div id=content> <article class=post> <div class=meta> <span><img src="/assests/images/date.png"/>23 Aug 2011</span> <span><img src="/assests/images/comments.png"/><a href="/2011/08/quick-script-to-get-public-ips-on-a-natd-server/#disqus_thread">Comments</a></span> <ul id=categories> <li><a href='/tag/foss'>FOSS</a></li><li><a href='/tag/fun'>Fun</a></li><li><a href='/tag/knowledge-base'>Knowledge base</a></li><li><a href='/tag/linux'>Linux</a></li><li><a href='/tag/bash'>Bash</a></li><li><a href='/tag/curl'>Curl</a></li><li><a href='/tag/ips'>Ips</a></li><li><a href='/tag/nat'>Nat</a></li></ul> </div> <div class=entry> <p>A quick one liner to get the public equivalent of internal IPs on a box behind NAT:</p> <div class=highlight><pre><code class="bash"><span class="k">for </span>int in <span class="k">$(</span>ifconfig | grep <span class="s2">&quot;Link encap:&quot;</span> | awk <span class="s1">&#39;{print $1}&#39;</span> | grep -v <span class="s1">&#39;lo&#39;</span><span class="k">)</span>; <span class="k">do </span><span class="nb">echo</span> <span class="s2">&quot;$int: $(ifconfig $int | grep &quot;</span>inet addr:<span class="s2">&quot; | awk &#39;{print $2}&#39; | cut -d: -f2) =&gt; $(curl -s --interface $int ipv4.canhazip.info)&quot;</span>; <span class="k">done</span>
</code></pre> </div> <p>I've restricted this to IPv4 only - NATing IPv6 is just silly but if you really want then it is on your head.</p> <p>Example usage is as follows:</p> <div class=highlight><pre><code class="bash"><span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span><span class="k">for </span>int in <span class="k">$(</span>ifconfig | grep <span class="s2">&quot;Link encap:&quot;</span> | awk <span class="s1">&#39;{print $1}&#39;</span> | grep -v <span class="s1">&#39;lo&#39;</span><span class="k">)</span>; <span class="k">do </span><span class="nb">echo</span> <span class="s2">&quot;$int: $(ifconfig $int | grep &quot;</span>inet addr:<span class="s2">&quot; | awk &#39;{print $2}&#39; | cut -d: -f2) =&gt; $(curl -s --interface $int ipv4.canhazip.info)&quot;</span>; <span class="k">done</span>
br0: 10.44.200.5 <span class="o">=</span>&gt; 89.242.208.82
br0:1: 10.44.200.15 <span class="o">=</span>&gt; 89.242.208.82
cluevpn: 10.156.1.49 <span class="o">=</span>&gt; 89.242.208.82
eth0: <span class="o">=</span>&gt;
vnet0: <span class="o">=</span>&gt;
</code></pre> </div> <p>Or if you want IPv6 addresses returned:</p> <div class=highlight><pre><code class="bash"><span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span><span class="k">for </span>int in <span class="k">$(</span>ifconfig | grep <span class="s2">&quot;Link encap:&quot;</span> | awk <span class="s1">&#39;{print $1}&#39;</span> | grep -v <span class="s1">&#39;lo&#39;</span><span class="k">)</span>; <span class="k">do </span><span class="nb">echo</span> <span class="s2">&quot;$int: $(ifconfig $int | grep &quot;</span>inet addr:<span class="s2">&quot; | awk &#39;{print $2}&#39; | cut -d: -f2) =&gt; $(curl -s --interface $int canhazip.info)&quot;</span>; <span class="k">done</span>
br0: 10.44.200.5 <span class="o">=</span>&gt; 2001:470:9083::2
br0:1: 10.44.200.15 <span class="o">=</span>&gt;
cluevpn: 10.156.1.49 <span class="o">=</span>&gt;
eth0: <span class="o">=</span>&gt;
vnet0: <span class="o">=</span>&gt;
</code></pre> </div> </div> </article> <section id=related> <h2>Related posts</h2> <ul id=related_posts> <li>&raquo; <a href="/2012/09/slow-ssh-to-new-centos-servers/">Slow SSH to new CentOS servers</a></li> <li>&raquo; <a href="/2012/09/kvirc-update-breaks-irssi-proxy/">KVIrc update breaks Irssi Proxy</a></li> <li>&raquo; <a href="/2012/08/running-a-wsgi-app-via-gunicorn-from-python/">Running a WSGI app via Gunicorn from Python</a></li> </ul> </section> <section id=comment> <h2>Comments</h2> <div id=disqus_thread aria-live=polite> <noscript>Please enable JavaScript to view the comments</noscript> </div> </section> <script type="text/javascript">var disqus_shortname="damianzaremba";var disqus_identifier="http://damianzaremba.co.uk/2011/08/quick-script-to-get-public-ips-on-a-natd-server/";var disqus_url="http://damianzaremba.co.uk/2011/08/quick-script-to-get-public-ips-on-a-natd-server/";var disqus_script="embed.js";(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="http://"+disqus_shortname+".disqus.com/"+disqus_script;(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script> </div> <footer> <p class=copyright>Copyright 2009-2012 <a href="http://damianzaremba.co.uk">Damian Zaremba</a></p> <p class=ads> <ul id=ads> <li>Need error logging? Try <a href="https://getsentry.com/signup/r_D0ZW/">Sentry</a></li> <li>Need hosting? Try <a href="http://www.vision108.com/">Vision180</a></li> <li>Want my website? <a href="http://github.com/DamianZaremba/damianzaremba.co.uk/">Source</a></li> </ul> </p> </footer> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script> <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script> <script type="text/javascript">!window.jQuery&&document.write(unescape('%3Cscript src="/assests/js/jquery.js"%3E%3C/script%3E'));</script><![endif]--> <script type="text/javascript">!window.jQuery&&document.write(unescape('%3Cscript src="/assests/js/jquery.js"%3E%3C/script%3E'));var disqus_shortname="damianzaremba";var disqus_script="count.js";(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="http://"+disqus_shortname+".disqus.com/"+disqus_script;(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script> </body> </html>
<!DOCTYPE html> <html lang=en> <head> <title>Damian Zaremba - Blog</title> <meta charset=utf-8> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"> <meta http-equiv=Content-Type content="text/html; charset=UTF-8"/> <meta name=description content="Damian Zaremba's Blog"/> <meta name=google-site-verification content=qykIg-4DghoGe78ET4eRjKG1cx6n3gXvu4jF0FvcwRo /> <meta name=author content="Damian Zaremba"/> <link rel=alternate type="application/rss+xml" title="Damian Zaremba's Blog" href="http://feeds.feedburner.com/DamianZaremba"/> <meta name=robots content=INDEX /> <meta name=robots content=FOLLOW /> <meta name=robots content="INDEX,FOLLOW"/> <link href="/assests/css/bootstrap.min.css?_v=58a49b3689d699cb72ffda7252d99fcb" rel=stylesheet> <link href="/assests/css/main.css?_v=628744fb77a1130b2b8d63e77a95b03a" rel=stylesheet> </head> <body> <nav class="navbar navbar-default navbar-fixed-top"> <div class=container> <div class=navbar-header> <button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target="#navbar" aria-expanded=false aria-controls=navbar> <span class=sr-only>Open navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href="/">Damian Zaremba</a> </div> <div id=navbar> <div class="collapse navbar-collapse"> <ul class="nav navbar-nav"> <li class=active><a href="/">Blog</a></li> <li class=""><a href="/about/">About</a></li> <li class=""><a href="/cv/">CV</a></li> <li class=""><a href="/archive/">Archive</a></li> <li class=""><a href="/projects/">Projects</a></li> <li class=""><a href="/todo/">Todo</a></li> </ul> <div class="social-icons navbar-right"> <a href="http://twitter.com/DamianZaremba"> <img class=twitter src="/assests/images/twitter.png?_v=5c9d07bd2ff1f5224934583b6be57b0a" alt=Twitter /> </a> <a href="https://github.com/DamianZaremba"> <img class=github src="/assests/images/github.png?_v=438c17272c5f0e9f4a6da34d3e4bc5bd" alt=GitHub /> </a> <a href="http://feeds.feedburner.com/DamianZaremba"> <img class=rss src="/assests/images/rss.png?_v=f6fa89d6cfe5f5e95f0f87205d8c4b11" alt=RSS /> </a> </div> </div> </div> </div> </nav> <div class=container> <article class=post> <h1 class=title><a href="/2011/08/php-curl-dual-stack-issue/">PHP CURL dual stack issue</a></h1> <div class=meta> <span><img src="/assests/images/date.png?_v=1673aede74ad16063dfcd243a3d61d41" title=Date alt=Date />18 Aug 2011</span> <span><img src="/assests/images/comments.png?_v=33159642eac6a274ec5483d1bc54f52c" title=Content alt=Content /><a href="/2011/08/php-curl-dual-stack-issue/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/foss'>FOSS</a></li><li><a href='/tag/how-to'>How-to</a></li><li><a href='/tag/linux'>Linux</a></li><li><a href='/tag/curl'>Curl</a></li><li><a href='/tag/php'>Php</a></li></ul> </div> <div class=entry> <p>I had a slightly strange issue this morning with PHP and curl (multi_curl actually but it affects curl too). ClueBot NG was returning API errors all over the place, after a quick look though the main code it appeared that the data from the toolserver API wasn't getting returned properly. Trying to get the headers from the curl handler went no where, everything was returning back empty or NULL.</p> <p>After testing the code on a different machine and it working fine I started to look at the URL that was being requested, a quick curl (on the command line) found that it hung. Off I went to look at its DNS entries and realised the tunnel on the server had dropped again (really need to get the server admin to move the tunnel somewhere more stable).</p> <p>Now you would expect that if you cannot get traffic out on IPv6 that CURL would fall back to IPv4, it appears that it doesn't! What actually happens is it sits trying IPv6 until the connection timeout is hit then, showing no warning/error returns back NULL data. Yay for CURL!</p> <p>A quick fix (until the datacenter gets native IPv6) is to force CURL to use ipv4 when resolving domain names. Now anyone that has looked at developing things in C with CURL will know this is really easy, however the PHP bindings don't even document that you can set the IPRESOLVE option, but you can! Yay for php...</p> <p>The option is CURLOPT_IPRESOLVE and the value is either CURL_IPRESOLVE_V4, CURL_IPRESOLVE_V6 or CURL_IPRESOLVE_WHATEVER. To force IPv4 just use:</p> <pre><code class="php">curl_setopt( $ch, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4 );
</code></pre> <p>My test script in a broken state is:</p> <pre><code class="php">&lt;?php
 $ch = curl_init();
 curl_setopt( $ch, CURLOPT_USERAGENT, 'ClueBot/2.0' );
 if( isset( $proxyhost ) and isset( $proxyport ) and $proxyport != null and $proxyhost != null ) {
 curl_setopt( $ch, CURLOPT_PROXYTYPE, isset( $proxytype ) ? $proxytype : CURLPROXY_HTTP );
 curl_setopt( $ch, CURLOPT_PROXY, $proxyhost );
 curl_setopt( $ch, CURLOPT_PROXYPORT, $proxyport );
 }
 curl_setopt( $ch, CURLOPT_URL, "http://toolserver.org/~cobi/cb.php?user=124.124.10.106&amp;ns=0&amp;title=Sayala&amp;timestamp=1313668350" );
 curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, 1 );
 curl_setopt( $ch, CURLOPT_MAXREDIRS, 10 );
 curl_setopt( $ch, CURLOPT_HEADER, 1 );
 curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );
 curl_setopt( $ch, CURLOPT_TIMEOUT, 120 );
 curl_setopt( $ch, CURLOPT_CONNECTTIMEOUT, 10 );
 curl_setopt( $ch, CURLOPT_HTTPGET, 1 );
 curl_setopt( $ch, CURLOPT_ENCODING, '' );

var_dump( curl_exec( $ch ) );
?&gt;
</code></pre> <p>And the test script in the fixed status is:</p> <pre><code class="php">&lt;?php
 $ch = curl_init();
 curl_setopt( $ch, CURLOPT_USERAGENT, 'ClueBot/2.0' );
 if( isset( $proxyhost ) and isset( $proxyport ) and $proxyport != null and $proxyhost != null ) {
 curl_setopt( $ch, CURLOPT_PROXYTYPE, isset( $proxytype ) ? $proxytype : CURLPROXY_HTTP );
 curl_setopt( $ch, CURLOPT_PROXY, $proxyhost );
 curl_setopt( $ch, CURLOPT_PROXYPORT, $proxyport );
 }
 curl_setopt( $ch, CURLOPT_URL, "http://toolserver.org/~cobi/cb.php?user=124.124.10.106&amp;ns=0&amp;title=Sayala&amp;timestamp=1313668350" );
 curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, 1 );
 curl_setopt( $ch, CURLOPT_MAXREDIRS, 10 );
 curl_setopt( $ch, CURLOPT_HEADER, 1 );
 curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );
 curl_setopt( $ch, CURLOPT_TIMEOUT, 120 );
 curl_setopt( $ch, CURLOPT_CONNECTTIMEOUT, 10 );
 curl_setopt( $ch, CURLOPT_HTTPGET, 1 );
 curl_setopt( $ch, CURLOPT_ENCODING, '' );
 curl_setopt( $ch, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4 );

var_dump( curl_exec( $ch ) );
?&gt;
</code></pre> <p>Simples!</p> </div> </article> <article class=post> <h1 class=title><a href="/2011/07/centos-6-0-kickstart-partitioning-issue/">Centos 6.0 kickstart partitioning issue</a></h1> <div class=meta> <span><img src="/assests/images/date.png?_v=1673aede74ad16063dfcd243a3d61d41" title=Date alt=Date />10 Jul 2011</span> <span><img src="/assests/images/comments.png?_v=33159642eac6a274ec5483d1bc54f52c" title=Content alt=Content /><a href="/2011/07/centos-6-0-kickstart-partitioning-issue/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/foss'>FOSS</a></li><li><a href='/tag/anaconda'>Anaconda</a></li><li><a href='/tag/kickstart'>Kickstart</a></li></ul> </div> <div class=entry> <p>In my kickstart files I "cheat" on disk sizes and let them grow automatically rather than figuring out the size, setting it then having to manually expand it later.</p> <p>To do this I use the following in my kickstarts:</p> <pre><code class="text">%include /tmp/partinfo

%pre
# Get disks
set $(list-harddrives)
let numd=$#/2
disk1=$1
disk2=$3

# Build partinfo file
cat &gt; /tmp/partinfo &lt;part /boot --fstype ext4 --size=512 --ondisk=$disk1
part pv.2 --size=0 --grow --ondisk=$disk1

volgroup VolGroup00 --pesize=32768 pv.2
logvol / --fstype ext4 --name=LogVol00 --vgname=VolGroup00 --size=1024 --grow
logvol swap --fstype swap --name=LogVol01 --vgname=VolGroup00 --size=512 --grow --maxsize=1024
EOF
</code></pre> <p>Basically in the pre section of the kickstart I write out the disk partition stuff using some bash/list-harddrives into a file. This is then included in the main body of the kickstart (due to the pre code being run before the main stuff this works fine).</p> <p>Now the issue I had with Centos6 was an error getting throw by Anaconda "Partition requires a size specification".</p> <p>It looks like this is caused by a change in the kickstart script which checks if the size is set (pd.size = None was changed to not self.size).</p> <p>The simplest way to fix this is just to make --size=1 (lets face it, your minimum partition size isn't going to be smaller 1mb!).</p> <p>Apart from some other little things like removing the editors, text-internet etc groups out of the kickstart file and downloading the new vmlinuz/initrd.img files everything worked fine first time.</p> <p>Now to wait for the mirror to finish syncing so I can get some fast installs going (=</p> </div> </article> <article class=post> <h1 class=title><a href="/2011/06/twitter/">Twitter?</a></h1> <div class=meta> <span><img src="/assests/images/date.png?_v=1673aede74ad16063dfcd243a3d61d41" title=Date alt=Date />28 Jun 2011</span> <span><img src="/assests/images/comments.png?_v=33159642eac6a274ec5483d1bc54f52c" title=Content alt=Content /><a href="/2011/06/twitter/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/general'>General</a></li></ul> </div> <div class=entry> <p>It appears twitter decided to have a re-style once again as can be seen below;</p> <p><strong>2011</strong></p> <p><img src="/2011/06/twitter/twitter1.png" alt=""/></p> <p><strong>2010</strong></p> <p><img src="/2011/06/twitter/twitter2.png" alt=""/></p> <p><strong>2009</strong></p> <p><img src="/2011/06/twitter/twitter3.png" alt=""/></p> <p>They also keep playing with the web theme as well, mainly the homepage which has changed twice this year and the login link colours which last week where orange but are now back to white.</p> <p>I think they should focus more on scaling their API and web stack so that they can remove the API limits and increase the platform stability.</p> <p>Things could change now they have purchased tweetdeck however this may just slowly replace the "official" twitter client.</p> <p>The recent changes to send email notifications on events also seems to be a step backwards - they are moving things away from near-real time to slow time. The notifications also seem to be quite slow along with the search feeds which I hope they speed up soon.</p> <p>The one notification I wouldn't mind getting via email is unfollow notifications, I currently rely on third-party services +a bunch of Perl for them.</p> </div> </article> <article class=post> <h1 class=title><a href="/2011/06/quick-update/">Quick update</a></h1> <div class=meta> <span><img src="/assests/images/date.png?_v=1673aede74ad16063dfcd243a3d61d41" title=Date alt=Date />28 Jun 2011</span> <span><img src="/assests/images/comments.png?_v=33159642eac6a274ec5483d1bc54f52c" title=Content alt=Content /><a href="/2011/06/quick-update/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/general'>General</a></li></ul> </div> <div class=entry> <p>Well, it has been a while.</p> <p>Currently just merging wiki.damianzaremba.co.uk (most the stuff is hidden at the moment) and thegeekstop.net into this single blog.</p> <p>Once everything is merged learnabouttheweb.co.uk and thegeekstop.net will point to damianzaremba.co.uk/blog/!</p> <p>Apart from my tumblr account (which I post random pictures too) I don't see the point in having separate blogs all over the place.</p> <p>Here will become my random content, how to, scripts and generally anything I get time to post about.</p> <p>Some topics I'm trying to catch up on at the moment are:</p> <ul> <li><p>Camping/outdoor skills</p></li> <li><p>Bushcraft skills</p></li> <li><p>New equipment</p></li> <li><p>Tech items</p></li> <li><p>Events</p></li> <li><p>Other stuff...</p></li> </ul> <p>I also intend to get the calendar up to date (it is missing a LOT of stuff at the moment but the first items on that to-do list are syncing up the scout calendars with the activity plans for the year. If I can find a decent video editing app/camera then I might start using you tube more for publishing content.</p> <p>Currently quite busy as there is a lot of stuff going on, lots of ideas for next year and plans for this - will post more about them later.</p> </div> </article> <article class=post> <h1 class=title><a href="/2011/06/meth-stove/">Meth stove</a></h1> <div class=meta> <span><img src="/assests/images/date.png?_v=1673aede74ad16063dfcd243a3d61d41" title=Date alt=Date />28 Jun 2011</span> <span><img src="/assests/images/comments.png?_v=33159642eac6a274ec5483d1bc54f52c" title=Content alt=Content /><a href="/2011/06/meth-stove/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/general'>General</a></li><li><a href='/tag/iscout'>iScout</a></li></ul> </div> <div class=entry> <p>I saw pretty cool stove the other day and decided to have a go at it.</p> <p>The final stove was a little messy but <em>should</em> work fine - I'm going to test it on Thursday and see if it works or not.</p> <p><img src="/2011/06/meth-stove/IMG_0356-225x300.jpg" alt=""/></p> <p>Some notes before starting that I found out the hard way:</p> <ul> <li>Be careful once you start making cuts - You end up with tiny bits of metal that are <em>very</em> sharp.</li> <li>File off the edges - It makes the metal easier to work with and stops you from slicing your fingers open.</li> <li>Measure the height of your inner wall - It makes fitting the thing together much easier.</li> <li>Don't slice down the side of the can when scoring off the bottoms - This makes it easier to get the bottoms off but means you need a spare can for the inner.</li> <li>Be careful when making the holes in the top - I started out with a pin that made nice round holes then broke it so used a knife that made much bigger "slots".</li> <li>When rolling your inner wall use a bit of tape - it will burn off later.</li> </ul> <h2>How to</h2> <p>First you are going to need:</p> <ul> <li>2 x Empty drinks cans</li> <li>1 x Very sharp knife</li> <li>1 x File</li> <li>1 x Saw (You could use your knife but a saw makes it easier)</li> <li>1 pair of scissors (Once again you could use your knife but this makes it easier)</li> </ul> <h3>Step1</h3> <p>Firstly take 1 empty can and turn it upside down so the end <em>without</em> a hole is at the top for you to work on.</p> <p>Carefully punch a bunch of holes around the outside for burners and a few holes right in the middle for filling.</p> <p>Make sure not to put the middle holes too close to the outside - you need enough space for the middle wall to separate the fuel.</p> <p>You should end up with something like this...</p> <p><img src="/2011/06/meth-stove/IMG_0357.jpg" alt=""/></p> <h3>Step2</h3> <p>Next you need to cut off the bottom of the can (the actual bottom, where you just made holes in). This will be the "top" of your burner.</p> <p>An easy way is to clip your knife onto the back of a book then score around the outside.</p> <p>Once you have a good score line take your saw and run it around to make a cut.</p> <p>Then after you have just the bottom of the can left take your file and smooth off the top. If need be use your scissors/knife to trim off any crap.</p> <h3>Step3</h3> <p>Now you need to make an inner wall which fits around the "dip" in your burners top.</p> <p>Slice down the side of the can (use the bit you just cut off) and remove the top of the can.</p> <p>You should be left with basically the body of the can (you may need to use another can depending how big you cut the top of your stove)</p> <p>Now roll it up to fit around the dip in your burners top and mark it with your knife.</p> <p>Take a pair of scissors and cut it down to size then tape both ends just to hold it in place.</p> <p>I taped it a little smaller than it needed to be then pushed it around the dip - this made a tight fit so the next step was easier.</p> <h3>Step4</h3> <p>Cut out some notches in the top of your inner wall - this will be where the fuel can flow though into the bottom of the burner.</p> <p>You should end up with a circle of notches sticking out the top of your burner top.</p> <h3>Step5</h3> <p>Now to make the burner bottom, take another empty can and measure it against your burner top.</p> <p>You want to make it about 1½ times the size of the burner top.</p> <p>This will fit over your burner top and make the base of the burner where the fuel flows into.</p> <h3>Step6</h3> <p>Now we need to fix the bottom to the top.</p> <p>You want to end up with your inner wall matching up with your little dip in the bottom of the burner as you did with the top.</p> <p>You can use a spare piece of the side to help you ease the cans together.</p> <p>You should get a really tight fit - I had to cut down and file off the outer can after as I did the measuring wrong.</p> <p>Now you should basically have a can with an inner can - You put the fuel in the middle and it flows down to the bottom of the can where you can light it.</p> <h2>Footnotes</h2> <p>I've seen a few other people's stoves and they seem to cut them down to just under 2".</p> <p>Mine ended up slightly bigger as can be seen below. I'm not sure how this will affect its performance but it should produce a better cooking height.</p> <p><img src="/2011/06/meth-stove/IMG_0358-225x300.jpg" alt=""/> <img src="/2011/06/meth-stove/IMG_0359-225x300.jpg" alt=""/></p> <p>Another thing that was done differently was the number of burners - this will probably use more fuel but should produce a larger heat.</p> <h3>Other</h3> <p>I'm going to light this on Thursday and see if it works fine - It might explode or work fine. I think I slightly crimped the inner wall while fitting it together.</p> <p>If it works fine I'll probably build another and document it better else I'll do a design review. As long as my phone doesn't die on me I'll try to get a video of lighting it which could turn out quite funny...</p> <p>Update: The stove didn't work very well - upon lighting it the meths burnt off in a big puff of singed hair and wouldn't turn into anything more.</p> <p>I'm guessing the holes where too big causes a massive rush of oxygen into the fuel "store" and it burning off very quickly.</p> <p>I'll have another go at building one some time soon as I burnt this attempted (we had a reasonably sized fire, what else would you do) and let you know if it turns out any better.</p> </div> </article> <nav id=page_nav> <a href="/6/" class=prev>&laquo; Previous Page</a> <a href="/8/" class=next>Next Page &raquo;</a> </nav> </div> <footer class=footer> <div class=container> <p class=text-muted>Copyright 2009-2015 <a href="http://damianzaremba.co.uk">Damian Zaremba</a></p> <ul id=ads> <li>Need error logging? Try <a href="https://getsentry.com/signup/r_D0ZW/">Sentry</a></li> <li>Need cloud instances? Jump on <a href="http://www.bigv.io">BigV</a></li> <li>Want my website? <a href="https://github.com/DamianZaremba/damianzaremba.co.uk/">Source</a></li> </ul> </div> </footer> <script src="/assests/js/jquery.min.js?_v=5790ead7ad3ba27397aedfa3d263b867"></script> <script src="/assests/js/bootstrap.min.js?_v=046ba2b5f4cff7d2eaaa1af55caa9fd8"></script> <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]);_gaq.push(["_setAccount","UA-11817192-1"]);_gaq.push(["_setDomainName","damianzaremba.co.uk"]);_gaq.push(["_trackPageview"]);(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="//stats.g.doubleclick.net/dc.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)})();(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//damianzaremba.disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script> <!--[if lt IE 9]><script src="/assests/js/html5shiv.min.js?_v=3044234175ac91f49b03ff999c592b85"></script> <script src="/assests/js/respond.min.js?_v=afc1984a3d17110449dc90cf22de0c27"></script><![endif]--> </body> </html>
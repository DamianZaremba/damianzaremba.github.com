<!DOCTYPE HTML> <html> <head> <title>Damian Zaremba - Blog</title> <meta http-equiv=Content-Type content="text/html; charset=UTF-8"/> <meta name=description content="Damian Zaremba's Blog"/> <meta name=google-site-verification content=qykIg-4DghoGe78ET4eRjKG1cx6n3gXvu4jF0FvcwRo /> <meta name=author content="Damian Zaremba"/> <link rel=alternate type="application/rss+xml" title="Damian Zaremba's Blog" href="http://feeds.feedburner.com/DamianZaremba"/> <meta name=robots content=INDEX /> <meta name=robots content=FOLLOW /> <meta name=robots content="INDEX,FOLLOW"/> <link href="//damianzaremba.co.uk/assests/css/main.css" rel=stylesheet type="text/css"/> <link href="//damianzaremba.co.uk/assests/css/pygments.css" rel=stylesheet type="text/css"/> <script src="//mint.damianzaremba.co.uk/?js" type="text/javascript"></script> <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]);_gaq.push(["_setAccount","UA-11817192-1"]);_gaq.push(["_setDomainName","damianzaremba.co.uk"]);_gaq.push(["_trackPageview"]);(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="//stats.g.doubleclick.net/dc.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)})();</script> <!--[if IE]>body { behavior: url("//damianzaremba.co.uk/assests/other/hover.htc"); }<![endif]--> </head> <body> <header> <h1><a href="/">Damian Zaremba</a> <span>Blog</span></h1> <nav> <ul id=main> <li><a href="/">Blog</a></li> <li><a href="/about/">About</a></li> <li><a href="/cv/">CV</a></li> <li><a href="/archives/">Archives</a></li> <li><a href="/projects/">Projects</a></li> <li><a href="/todo/">Todo</a></li> </ul> </nav> <div id=right> <p> <a href="http://twitter.com/DamianZaremba"> <img src="//damianzaremba.co.uk/assests/images/twitter.png" alt=Twitter /> </a> <a href="https://plus.google.com/110559147647328161061"> <img src="//damianzaremba.co.uk/assests/images/googleplus.png" alt=GooglePlus /> </a> <a href="http://facebook.com/DamianZaremba"> <img src="//damianzaremba.co.uk/assests/images/facebook.png" alt=Facebook /> </a> <a href="https://github.com/DamianZaremba"> <img src="//damianzaremba.co.uk/assests/images/github.png" alt=GitHub /> </a> <a href="http://feeds.feedburner.com/DamianZaremba"> <img src="//damianzaremba.co.uk/assests/images/rss.png" alt=RSS /> </a> </p> <form class=search action="https://google.com/search" method=get> <input class=left type=text name=q> <input type=hidden name=q value="site:damianzaremba.co.uk"> </form> </div> </header> <div id=content> <article class=post> <h1 class=title><a href="/2011/11/restricting-access-to-edgecast-nodes/">Restricting access to EdgeCast nodes</a></h1> <div class=meta> <span><img src="/assests/images/date.png" title=Date alt=Date />02 Nov 2011</span> <span><img src="/assests/images/comments.png" title=Content alt=Content /><a href="/2011/11/restricting-access-to-edgecast-nodes/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/apache'>Apache</a></li><li><a href='/tag/cat'>Cat</a></li><li><a href='/tag/cdn'>CDN</a></li><li><a href='/tag/edgecast'>Edgecast</a></li><li><a href='/tag/linux'>Linux</a></li><li><a href='/tag/mod_rewrite'>Mod_rewrite</a></li><li><a href='/tag/sed'>Sed</a></li></ul> </div> <div class=entry> <p>Today one of our clients published a mix track that was around 140mb, hosted on their account. This was no problem until he started to get hundreds of people downloading the mix which resulted in silly amounts of bandwidth being used.</p> <p>We quickly had to move him on to the CDN to ensure the traffic impact wasn't affecting performance for him or others as well as reduce his bandwidth charges substantially.</p> <p>Once the CDN was all set up and the content pushed out onto the nodes we started to send traffic over.</p> <p>Due to the impact of social media and people linking directly to the content we had to devise a plan to enable access to the content for the CDN but redirect anyone linking directly to the CDNified subdomain.</p> <p>In comes mod_rewrite. Now it appears EdgeCast don't publish their IP ranges in any format that helps my sanity, they are in fact published in a html table. To find them, login to my.edgecast.com, browse to HTTP Large, click on Customer Origin and scroll down to the bottom.</p> <p>Linux to the rescue! First we just copy the list into a file:</p> <div class=highlight><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span>cat &gt; edgecast_ranges
Asia Hong Kong 117.18.234.0 - 117.18.234.255
110.232.176.0 - 110.232.176.255
Asia Singapore 117.18.236.0 - 117.18.236.255
46.22.71.0 - 46.22.71.255
Asia Tokyo 117.18.233.0 - 117.18.233.255
110.232.177.0 - 110.232.177.255
Australia Sydney 117.18.235.0 - 117.18.235.255
110.232.179.0 - 110.232.179.255
Europe Amsterdam 93.184.208.0 - 93.184.208.255
93.184.209.0 - 93.184.209.255
93.184.217.0 - 93.184.217.255
46.22.70.0 - 46.22.70.255
46.22.72.0 - 46.22.73.255
Europe Frankfurt 72.21.89.0 - 72.21.89.255
93.184.212.0 - 93.184.212.255
93.184.213.0 - 93.184.213.255
Europe London 72.21.90.0 - 72.21.90.255
93.184.210.0 - 93.184.210.255
93.184.211.0 - 93.184.211.255
46.22.74.0 - 46.22.75.255
Europe Madrid 46.22.66.0 - 46.22.67.255
Europe Paris 93.184.214.0 - 93.184.214.255
North America Ashburn 72.21.83.0 - 72.21.83.255
68.232.36.0 - 68.232.36.255
North America Atlanta 72.21.88.0 - 72.21.88.255
72.21.93.0 - 72.21.93.255
North America Chicago 72.21.87.0 - 72.21.87.255
68.232.38.0 - 68.232.38.255
North America Dallas 72.21.86.0 - 72.21.86.255
68.232.39.0 - 68.232.39.255
North America Los Angeles 72.21.84.0 - 72.21.84.255
68.232.40.0 - 68.232.40.255
72.21.94.0 - 72.21.94.255
93.184.218.0 - 93.184.218.255
46.22.69.0 - 46.22.69.255
North America Miami 46.22.64.0 - 46.22.65.255
North America New York 72.21.95.0 - 72.21.95.255
68.232.37.0 - 68.232.37.255
North America San Jose
North America San Jose 72.21.82.0 - 72.21.82.255
68.232.41.0 - 68.232.41.255
North America Seattle 72.21.85.0 - 72.21.85.255
Other N/A 72.21.80.0 - 72.21.80.255
72.21.81.0 - 72.21.81.255
72.21.91.0 - 72.21.91.255
72.21.92.0 - 72.21.92.255
117.18.232.0 - 117.18.232.255
93.184.221.0 - 93.184.221.255
93.184.220.0 - 93.184.220.255
93.184.219.0 - 93.184.219.255
117.18.237.0 - 117.18.237.255
93.184.215.0 - 93.184.215.255
93.184.216.0 - 93.184.216.255
68.232.32.0 - 68.232.32.255
68.232.33.0 - 68.232.33.255
68.232.34.0 - 68.232.34.255
68.232.35.0 - 68.232.35.255
68.232.42.0 - 68.232.42.255
68.232.43.0 - 68.232.43.255
68.232.44.0 - 68.232.44.255
68.232.45.0 - 68.232.45.255
68.232.46.0 - 68.232.46.255
68.232.47.0 - 68.232.47.255
93.184.222.0 - 93.184.222.255
93.184.223.0 - 93.184.223.255
110.232.178.0 - 110.232.178.255
117.18.237.0 - 117.18.237.255
117.18.238.0 - 117.18.238.255
117.18.239.0 - 117.18.239.255</code></pre></div> <p>Next we need to clear out all the names etc that are randomly dumped in the file:</p> <div class=highlight><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span>sed -i <span class="s1">&#39;s/^.*\s.*\s//g&#39;</span> edgecast_ranges <span class="c"># Get rid of place names</span>
<span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span>sed -i <span class="s1">&#39;/^\s*$/d&#39;</span> edgecast_ranges <span class="c"># Get rid of blank lines</span></code></pre></div> <p>Now let's actually turn these IP ranges into something Apache can understand (they are all /24's so we can cheat):</p> <div class=highlight><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span>sed -i <span class="s1">&#39;s/^/RewriteCond %{REMOTE_ADDR} !^/g&#39;</span> edgecast_ranges <span class="c"># Add the rewrite cond</span>
<span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span>sed -i <span class="s1">&#39;s/\.255$/.*$/g&#39;</span> edgecast_ranges <span class="c"># Add the wildcard</span></code></pre></div> <p>Now let's create the actual htaccess file:</p> <div class=highlight><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">&#39;RewriteEngine On&#39;</span> &gt;&gt; .htaccess
<span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span>cat edgecast_ranges &gt;&gt; .htaccess
<span class="o">[</span>damian@finnix ~<span class="o">]</span><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">&#39;RewriteRule ^downloads/(.*)$ http://media.example.com/$1 [R,L]&#39;</span> &gt;&gt; .htaccess</code></pre></div> <p>You should end up with something looking like this:</p> <div class=highlight><pre><code class="language-bash" data-lang="bash">RewriteEngine On
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.234.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^110.232.176.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.236.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^46.22.71.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.233.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^110.232.177.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.235.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^110.232.179.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.208.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.209.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.217.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^46.22.70.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^46.22.72.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.89.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.212.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.213.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.90.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.210.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.211.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^46.22.74.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^46.22.66.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.214.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.83.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.36.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.88.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.93.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.87.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.38.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.86.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.39.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.84.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.40.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.94.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.218.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^46.22.69.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^46.22.64.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.95.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.37.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.82.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.41.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.85.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.80.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.81.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.91.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^72.21.92.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.232.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.221.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.220.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.219.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.237.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.215.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.216.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.32.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.33.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.34.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.35.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.42.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.43.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.44.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.45.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.46.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^68.232.47.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.222.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^93.184.223.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^110.232.178.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.237.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.238.*<span class="err">$</span>
RewriteCond %<span class="o">{</span>REMOTE_ADDR<span class="o">}</span> !^117.18.239.*<span class="err">$</span>
RewriteRule ^downloads/<span class="o">(</span>.*<span class="o">)</span><span class="nv">$ </span>http://media.example.com/<span class="nv">$1</span> <span class="o">[</span>R,L<span class="o">]</span></code></pre></div> <p>If you browse to http://example.com/downloads/ you should be redirected to http://media.example.com/ unless you are coming from an Edgecast IP range.</p> <p>Now you can go back to reading slashdot ;)</p> </div> </article> <article class=post> <h1 class=title><a href="/2011/08/changing-wordpress-tag-to-category/">Changing WordPress tag to category?</a></h1> <div class=meta> <span><img src="/assests/images/date.png" title=Date alt=Date />25 Aug 2011</span> <span><img src="/assests/images/comments.png" title=Content alt=Content /><a href="/2011/08/changing-wordpress-tag-to-category/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/foss'>FOSS</a></li><li><a href='/tag/how-to'>How-to</a></li><li><a href='/tag/software'>Software</a></li><li><a href='/tag/wordpress'>Wordpress</a></li><li><a href='/tag/category-to-tag'>Category to tag</a></li><li><a href='/tag/mysql'>Mysql</a></li><li><a href='/tag/tag-to-category'>Tag to category</a></li><li><a href='/tag/wordpress'>Wordpress</a></li></ul> </div> <div class=entry> <p>While there appears to be plugins for converting categories to tags, I can't for the life of me find one to convert tags to categories.</p> <p>After a quick poke around in the database it seem quite simple to convert between the two. Note: This /seems/ to work however it might kick you in the face and break stuff.</p> <p>First find out your "term" id (category or tag):</p> <div class=highlight><pre><code class="language-bash" data-lang="bash">mysql&gt; SELECT * FROM <span class="sb">`</span>terms<span class="sb">`</span> WHERE <span class="sb">`</span>slug<span class="sb">`</span> <span class="o">=</span> <span class="s1">&#39;snippets&#39;</span><span class="p">;</span>
+---------+----------+----------+------------+
<span class="p">|</span> term_id <span class="p">|</span> name <span class="p">|</span> slug <span class="p">|</span> term_group <span class="p">|</span>
+---------+----------+----------+------------+
<span class="p">|</span> <span class="m">171</span> <span class="p">|</span> Snippets <span class="p">|</span> snippets <span class="p">|</span> <span class="m">0</span> <span class="p">|</span>
+---------+----------+----------+------------+
<span class="m">1</span> row in <span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span></code></pre></div> <p>Now look in the taxonomy table and find out its details:</p> <div class=highlight><pre><code class="language-bash" data-lang="bash">mysql&gt; SELECT * FROM <span class="sb">`</span>term_taxonomy<span class="sb">`</span> WHERE <span class="sb">`</span>term_id<span class="sb">`</span> <span class="o">=</span> 171<span class="p">;</span>
+------------------+---------+----------+-------------+--------+-------+
<span class="p">|</span> term_taxonomy_id <span class="p">|</span> term_id <span class="p">|</span> taxonomy <span class="p">|</span> description <span class="p">|</span> parent <span class="p">|</span> count <span class="p">|</span>
+------------------+---------+----------+-------------+--------+-------+
<span class="p">|</span> <span class="m">174</span> <span class="p">|</span> <span class="m">171</span> <span class="p">|</span> post_tag <span class="p">|</span> <span class="p">|</span> <span class="m">0</span> <span class="p">|</span> <span class="m">17</span> <span class="p">|</span>
+------------------+---------+----------+-------------+--------+-------+
<span class="m">1</span> row in <span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span></code></pre></div> <p>As you can see it is currently a "post_tag".</p> <p>To change it to a category change the "taxonomy" field to "category":</p> <div class=highlight><pre><code class="language-bash" data-lang="bash">mysql&gt; UPDATE <span class="sb">`</span>term_taxonomy<span class="sb">`</span> SET <span class="sb">`</span>taxonomy<span class="sb">`</span> <span class="o">=</span> <span class="s1">&#39;category&#39;</span> WHERE <span class="sb">`</span>term_id<span class="sb">`</span> <span class="o">=</span> 171<span class="p">;</span>
Query OK, <span class="m">1</span> row affected <span class="o">(</span>0.00 sec<span class="o">)</span>
Rows matched: <span class="m">1</span> Changed: <span class="m">1</span> Warnings: 0</code></pre></div> <p>Or to change it from a category to a tag then change the "taxonomy" field to "post_tag":</p> <div class=highlight><pre><code class="language-bash" data-lang="bash">mysql&gt; UPDATE <span class="sb">`</span>term_taxonomy<span class="sb">`</span> SET <span class="sb">`</span>taxonomy<span class="sb">`</span> <span class="o">=</span> <span class="s1">&#39;post_tag&#39;</span> WHERE <span class="sb">`</span>term_id<span class="sb">`</span> <span class="o">=</span> 171<span class="p">;</span>
Query OK, <span class="m">1</span> row affected <span class="o">(</span>0.02 sec<span class="o">)</span>
Rows matched: <span class="m">1</span> Changed: <span class="m">1</span> Warnings: 0</code></pre></div> </div> </article> <article class=post> <h1 class=title><a href="/2011/08/changing-the-mysql-client-prompt/">Changing the MySQL client prompt</a></h1> <div class=meta> <span><img src="/assests/images/date.png" title=Date alt=Date />25 Aug 2011</span> <span><img src="/assests/images/comments.png" title=Content alt=Content /><a href="/2011/08/changing-the-mysql-client-prompt/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/foss'>FOSS</a></li><li><a href='/tag/knowledge-base'>Knowledge base</a></li><li><a href='/tag/linux'>Linux</a></li><li><a href='/tag/mysql'>Mysql</a></li><li><a href='/tag/my.cnf'>My.cnf</a></li><li><a href='/tag/mysql'>Mysql</a></li><li><a href='/tag/prompt'>Prompt</a></li></ul> </div> <div class=entry> <p>It is quite easy to get lost in MySQL when working between a lot of databases.</p> <p>While you can find out which database you are in, it soon becomes quite irritating having to type</p> <div class=highlight><pre><code class="language-bash" data-lang="bash">mysql&gt; <span class="k">select</span> database<span class="o">()</span><span class="p">;</span>

+------------------+
<span class="p">|</span> database<span class="o">()</span> <span class="p">|</span>
+------------------+
<span class="p">|</span> test_database <span class="p">|</span>
+------------------+
<span class="m">1</span> row in <span class="nb">set</span> <span class="o">(</span>0.01 sec<span class="o">)</span></code></pre></div> <p>The simplest way to solve this and make life easier, is to change the prompt to include the info! Simple edit the [mysql] section of your my.cnf file and add the prompt option:</p> <div class=highlight><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>client<span class="o">]</span>
<span class="nv">host</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span>
<span class="nv">user</span> <span class="o">=</span> <span class="s2">&quot;mehuser&quot;</span>
<span class="nv">pass</span> <span class="o">=</span> <span class="s2">&quot;someubersecurepassword&quot;</span>
<span class="nv">prompt</span><span class="o">=</span>mysql <span class="o">[</span><span class="se">\\</span>u@<span class="se">\\</span>h - <span class="se">\\</span>d<span class="o">]</span>&gt;</code></pre></div> <p>Now when you use the client the prompt will show mysql [user@host - database]>:</p> <div class=highlight><pre><code class="language-bash" data-lang="bash">mysql <span class="o">[</span>test1@localhost - test_database<span class="o">]</span>&gt;</code></pre></div> <p>No more getting confused! If you don't have access to /etc/my.cnf then use ~/.my.cnf, I usually stick the connection details in there as well - then you can have huge passwords and never have to type/remember them:</p> <div class=highlight><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>client<span class="o">]</span>
<span class="nv">host</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span>
<span class="nv">user</span> <span class="o">=</span> <span class="s2">&quot;mehuser&quot;</span>
<span class="nv">pass</span> <span class="o">=</span> <span class="s2">&quot;someubersecurepassword&quot;</span>
<span class="nv">prompt</span><span class="o">=</span>mysql <span class="o">[</span><span class="se">\\</span>u@<span class="se">\\</span>h - <span class="se">\\</span>d<span class="o">]</span>&gt;</code></pre></div> </div> </article> <article class=post> <h1 class=title><a href="/2011/08/useful-cpanel-paths/">Useful cPanel paths</a></h1> <div class=meta> <span><img src="/assests/images/date.png" title=Date alt=Date />23 Aug 2011</span> <span><img src="/assests/images/comments.png" title=Content alt=Content /><a href="/2011/08/useful-cpanel-paths/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/cpanel'>Cpanel</a></li><li><a href='/tag/knowledge-base'>Knowledge base</a></li><li><a href='/tag/linux'>Linux</a></li><li><a href='/tag/cpanel'>Cpanel</a></li><li><a href='/tag/data'>Data</a></li><li><a href='/tag/paths'>Paths</a></li></ul> </div> <div class=entry> <p>Some common and useful paths for cPanel are as below - please note that these may change at any time.</p> <table> <thead> <tr> <th>Location</th> <th>Contents</th> </tr> </thead> <tbody> <tr> <td>/etc/ips</td> <td>IP Addresses</td> </tr> <tr> <td>/etc/reservedips</td> <td>Reserved IP addresses</td> </tr> <tr> <td>/etc/reservedipreasons</td> <td>Reserved IP address reasons</td> </tr> <tr> <td>~/.accesshash</td> <td>WHM API key</td> </tr> <tr> <td>/etc/cpupdate.conf</td> <td>cPanel update configuration</td> </tr> <tr> <td>/etc/wwwacct.conf</td> <td>Basic cPanel config</td> </tr> <tr> <td>/var/cpanel/maxemailsperhour</td> <td>System wide max emails per hour setting</td> </tr> <tr> <td>/var/cpanel/packages</td> <td>cPanel packages</td> </tr> <tr> <td>/var/cpanel/users</td> <td>User data</td> </tr> <tr> <td>/var/cpanel/templates/apache2</td> <td>Apache vhost templates</td> </tr> <tr> <td>/usr/local/apache/conf/userdata/std/2/$user/$domain/configuration.conf</td> <td>Apache vhost config customizations for $user's $domain (not SSL)</td> </tr> <tr> <td>/usr/local/apache/conf/userdata/ssl/2/$user/$domain/configuration.conf</td> <td>Apache vhost config customizations for $user's $domain (SSL)</td> </tr> <tr> <td>/etc/userdomains</td> <td>Users domains</td> </tr> <tr> <td>/usr/local/cpanel/version</td> <td>cPanel version</td> </tr> <tr> <td>/var/cpanel/resellers</td> <td>Resellers</td> </tr> <tr> <td>/scripts</td> <td>Loads of useful cPanel related scripts</td> </tr> <tr> <td>/usr/local/cpanel/bin</td> <td>Loads of useful cPanel scripts</td> </tr> </tbody> </table> </div> </article> <article class=post> <h1 class=title><a href="/2011/08/upgrade-eol-clamav/">Upgrade EOL Clamav</a></h1> <div class=meta> <span><img src="/assests/images/date.png" title=Date alt=Date />23 Aug 2011</span> <span><img src="/assests/images/comments.png" title=Content alt=Content /><a href="/2011/08/upgrade-eol-clamav/#disqus_thread">Comments</a></span> <ul class=categories> <li><a href='/tag/knowledge-base'>Knowledge base</a></li><li><a href='/tag/linux'>Linux</a></li><li><a href='/tag/clamav'>Clamav</a></li><li><a href='/tag/eol'>Eol</a></li><li><a href='/tag/update'>Update</a></li></ul> </div> <div class=entry> <div class=highlight><pre><code class="language-text" data-lang="text">ClamAV have EOL&#39;d all their versions prior to 0.95 - if you see an error like the following then ClamAV needs an update:
 LibClamAV Warning: ***********************************************************
 LibClamAV Warning: *** This version of the ClamAV engine is outdated. ***
 LibClamAV Warning: *** DON&#39;T PANIC! Read http://www.clamav.net/support/faq ***
 LibClamAV Warning: ***********************************************************
 LibClamAV Error: cli_hex2str(): Malformed hexstring: This ClamAV version has reached End of Life! Please upgrade to version 0.95 or later. For more information see www.clamav.net/eol-clamav-094 and www.clamav.net/download (length: 169)
 LibClamAV Error: Problem parsing database at line 742
 LibClamAV Error: Can&#39;t load daily.ndb: Malformed database
 LibClamAV Error: cli_tgzload: Can&#39;t load daily.ndb
 LibClamAV Error: Can&#39;t load /var/lib/clamav/daily.cld: Malformed database
 ERROR: Malformed database</code></pre></div> <p>To upgrade ClamAV on a RHEL based system perform the following:</p> <ol> <li>wget http://pkgs.repoforge.org/clamav/clamav-0.96.1-1.el5.src.rpm</li> <li>yum install srpm unzip</li> <li>CFLAGS="-O0" ./configure --disable-zlib-vcheck</li> <li>make &amp;&amp; make install</li> <li>Update /usr/local/etc/clamd.conf (notably removing the "Example" line and un-commenting the TCP socket line).</li> </ol> <p>ClamAV should now work once again.</p> </div> </article> <nav id=page_nav> <a href="/2/" class=prev>&laquo; Previous Page</a> <a href="/4/" class=next>Next Page &raquo;</a> </nav> </div> <footer> <p class=copyright>Copyright 2009-2014 <a href="http://damianzaremba.co.uk">Damian Zaremba</a></p> <ul id=ads> <li>Need error logging? Try <a href="https://getsentry.com/signup/r_D0ZW/">Sentry</a></li> <li>Need cloud instances? Jump on <a href="http://www.bigv.io">BigV</a></li> <li>Want my website? <a href="https://github.com/DamianZaremba/damianzaremba.co.uk/">Source</a></li> </ul> </footer> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script> <!--[if lt IE 9]><script src="//damianzaremba.co.uk/assests/js/html5.js"></script><![endif]--> <script type="text/javascript">!window.jQuery&&document.write(unescape('%3Cscript src="//damianzaremba.co.uk/assests/js/jquery.js"%3E%3C/script%3E'));var disqus_shortname="damianzaremba";var disqus_script="count.js";(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/"+disqus_script;(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script> </body> </html>